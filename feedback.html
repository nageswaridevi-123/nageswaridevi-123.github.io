{% extends 'base.html' %}

{% block title %}Feedback - Paint System{% endblock %}

{% block extra_css %}
<style>
    .star-rating {
        display: flex;
        gap: 0.5rem;
        font-size: 3rem;
        margin: 2rem 0;
        justify-content: center;
    }
    .star {
        cursor: pointer;
        color: #ddd;
        transition: all 0.2s;
    }
    .star:hover,
    .star.active {
        color: #f39c12;
        transform: scale(1.1);
    }
</style>
{% endblock %}

{% block content %}
<div style="max-width: 600px; margin: 0 auto;">
    <h1 style="margin-bottom: 2rem; text-align: center;">Leave Your Feedback</h1>
    
    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; margin-bottom: 2rem; text-align: center;">
        <h3>Order #{{ order.order_number }}</h3>
        <p style="color: #7f8c8d; margin-top: 0.5rem;">Delivered on {{ order.updated_at|date:"d M Y" }}</p>
    </div>

    <form method="POST" style="background: white; padding: 2rem; border-radius: 10px; border: 1px solid #ddd;">
        {% csrf_token %}
        
        <div style="margin-bottom: 2rem;">
            <label style="display: block; text-align: center; font-size: 1.2rem; margin-bottom: 1rem;">
                <strong>How would you rate your experience?</strong>
            </label>
            <div class="star-rating" id="starRating">
                <span class="star" data-rating="1">⭐</span>
                <span class="star" data-rating="2">⭐</span>
                <span class="star" data-rating="3">⭐</span>
                <span class="star" data-rating="4">⭐</span>
                <span class="star" data-rating="5">⭐</span>
            </div>
            <input type="hidden" name="rating" id="ratingInput" required>
            <p style="text-align: center; color: #7f8c8d;" id="ratingText">Click on stars to rate</p>
        </div>

        <div style="margin-bottom: 2rem;">
            <label style="display: block; margin-bottom: 0.5rem;"><strong>Additional Comments (Optional)</strong></label>
            <textarea name="comment" rows="6" style="width: 100%; padding: 1rem; border: 1px solid #ddd; border-radius: 5px; resize: vertical;" placeholder="Tell us about your experience..."></textarea>
        </div>

        <button type="submit" class="btn" style="width: 100%; font-size: 1.2rem;">Submit Feedback</button>
    </form>
</div>

<script>
const stars = document.querySelectorAll('.star');
const ratingInput = document.getElementById('ratingInput');
const ratingText = document.getElementById('ratingText');
let selectedRating = 0;

const ratingMessages = {
    1: 'Poor - We\'re sorry to hear that',
    2: 'Fair - We can do better',
    3: 'Good - Thanks for your feedback',
    4: 'Very Good - We\'re glad you liked it',
    5: 'Excellent - Thank you so much!'
};

stars.forEach(star => {
    star.addEventListener('click', function() {
        selectedRating = parseInt(this.dataset.rating);
        ratingInput.value = selectedRating;
        updateStars();
        ratingText.textContent = ratingMessages[selectedRating];
    });

    star.addEventListener('mouseenter', function() {
        const hoverRating = parseInt(this.dataset.rating);
        stars.forEach((s, index) => {
            if (index < hoverRating) {
                s.classList.add('active');
            } else {
                s.classList.remove('active');
            }
        });
    });
});

document.getElementById('starRating').addEventListener('mouseleave', updateStars);

function updateStars() {
    stars.forEach((star, index) => {
        if (index < selectedRating) {
            star.classList.add('active');
        } else {
            star.classList.remove('active');
        }
    });
}

// Form validation
document.querySelector('form').addEventListener('submit', function(e) {
    if (!ratingInput.value) {
        e.preventDefault();
        alert('Please select a rating');
    }
});
</script>
{% endblock %}